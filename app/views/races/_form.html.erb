<%=form_with(model: @race) do |f|%>
    <%=f.label :name, "Race Name"%>
    <%=f.text_field :name%><br><br>
    <%=f.label :location, "Race Location"%>
    <%=f.text_field :location%><br><br>
    <%=f.label :date, "Race Date"%>
    <%=f.date_field :date%><br><br>
    <%=f.fields_for :type, @race.type do |t|%>
        <%if @race.type.name == nil%>
        <h4>Select the type of race or create a new one!</h4>
        <%=t.label "Type"%>
        <%=t.collection_select :id, Type.all.order(:distance).uniq, :id, :name, :prompt => 'Select Type'%><br><br>
        <%=t.label :name, "New Type (ex. 4 Miler)"%>
        <%=t.text_field :name%><br>
        <%=t.label :distance, "Distance (in miles)"%>
        <%=t.text_field :distance%><br><br>
        <%else%>
        <h4>Race Type</h4>
        <%=t.hidden_field :id%>
        <%=t.collection_select :id, Type.all.order(:distance).uniq, :id, :name, {:prompt => true, :selected => @race.type.id}%><br><br>
        <%end%>
    <%end%>
    <%=f.hidden_field :public%>
    <%if @race.type == nil%>
        <h4>Add Your Finisher Stats</h4>
    <%else%>
        <h4>Update Your Finisher Stats</h4>
    <%end%>
    <%=f.fields_for :statistic, current_user_stats_for_form(@race) do |s|%>
        <%=s.hidden_field :id%>
        <%=s.label :finish_time, "Finish Time"%>
        <%=s.text_field :finish_time, value: finish_time_value(@race), placeholder: "hh:mm:ss", pattern: /\d{2}:[012345][0-9]:[012345][0-9]/%><br>
        <%=s.label :finish_pace, "Finish Pace"%>
        <%=s.text_field :finish_pace, value: finish_pace_value(@race), placeholder: "mm:ss", pattern: "[012345][0-9]:[012345][0-9]"%><br><br>
        <%=s.label :public, "Allow other users to see your finish stats (if race is public)"%>
        <%=s.check_box :public%><br><br>
        <%end%>
    <%=f.submit submit_button_text(@race)%>
        <%if @race.type != nil%>
        <div class="Delete Button"><%=link_to "Delete My Statistic", statistic_path(current_user_stats_for_form(@race)), :method => 'delete'%></div>
        <%end%>
<%end%>